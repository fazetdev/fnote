(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4108:function(e,t,s){Promise.resolve().then(s.bind(s,3758)),Promise.resolve().then(s.bind(s,5523)),Promise.resolve().then(s.bind(s,5324)),Promise.resolve().then(s.bind(s,7856)),Promise.resolve().then(s.t.bind(s,7059,23))},5324:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var n=s(587),i=s(5587);function r(){let[e,t]=(0,i.useState)(null),[s,r]=(0,i.useState)(!1),[a,o]=(0,i.useState)(!1);(0,i.useEffect)(()=>{o(!0);let e=e=>{e.preventDefault(),t(e),setTimeout(()=>{let e=localStorage.getItem("fnote_install_dismissed");e||r(!0)},5e3)};return window.addEventListener("beforeinstallprompt",e),window.matchMedia("(display-mode: standalone)").matches&&console.log("App is running in standalone mode"),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]);let l=async()=>{if(!e)return;e.prompt();let{outcome:s}=await e.userChoice;console.log("User ".concat(s," the install prompt")),t(null),r(!1),"dismissed"===s&&localStorage.setItem("fnote_install_dismissed","true")},c=()=>{r(!1),localStorage.setItem("fnote_install_dismissed","true")};return a&&s&&e?(0,n.jsx)("div",{className:"fixed bottom-20 left-4 right-4 z-50 md:left-auto md:right-4 md:w-80",children:(0,n.jsx)("div",{className:"bg-[#143b28] text-white p-4 rounded-xl shadow-xl border border-[#d4af37]/30",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"text-2xl",children:"\uD83D\uDCF1"}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"font-semibold text-[#d4af37]",children:"Install FNote"}),(0,n.jsx)("p",{className:"text-sm text-gray-300 mt-1",children:"Install this app on your device for faster access and offline use."}),(0,n.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,n.jsx)("button",{onClick:l,className:"flex-1 bg-[#d4af37] text-black py-2 rounded-lg font-medium hover:bg-[#c9a633] transition",children:"Install"}),(0,n.jsx)("button",{onClick:c,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition",children:"Later"})]})]}),(0,n.jsx)("button",{onClick:c,className:"text-gray-400 hover:text-white","aria-label":"Close",children:"✕"})]})})}):null}},7856:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var n=s(587),i=s(5587);function r(){let[e,t]=(0,i.useState)(!0),[s,r]=(0,i.useState)(!1),[a,o]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e=navigator.onLine;t(e),e||r(!0);let s=()=>{t(!0),r(!1),o(!0),setTimeout(()=>{o(!1)},3e3)},n=()=>{t(!1),r(!0),setTimeout(()=>{r(!1)},5e3)};return window.addEventListener("online",s),window.addEventListener("offline",n),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}},[]),(0,n.jsxs)(n.Fragment,{children:[s&&(0,n.jsx)("div",{className:"fixed bottom-4 right-4 z-50 animate-fade-in",children:(0,n.jsx)("div",{className:"bg-yellow-600/90 text-white px-3 py-2 rounded-lg shadow-lg backdrop-blur-sm border border-yellow-500/50",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-xs",children:"\uD83D\uDCE1"}),(0,n.jsx)("span",{className:"text-xs font-medium",children:"Offline mode"}),(0,n.jsx)("button",{onClick:()=>r(!1),className:"ml-2 text-xs opacity-70 hover:opacity-100","aria-label":"Dismiss",children:"✕"})]})})}),a&&(0,n.jsx)("div",{className:"fixed bottom-4 right-4 z-50 animate-fade-in",children:(0,n.jsx)("div",{className:"bg-emerald-600/90 text-white px-3 py-2 rounded-lg shadow-lg backdrop-blur-sm border border-emerald-500/50",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-xs",children:"✅"}),(0,n.jsx)("span",{className:"text-xs font-medium",children:"Back online"}),(0,n.jsx)("button",{onClick:()=>o(!1),className:"ml-2 text-xs opacity-70 hover:opacity-100","aria-label":"Dismiss",children:"✕"})]})})})]})}},5523:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var n=s(5587);function i(){return(0,n.useEffect)(()=>{"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("ServiceWorker registration successful:",e.scope)}).catch(e=>{console.log("ServiceWorker registration failed:",e)})})},[]),null}},3758:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return a}});var n=s(587),i=s(5587);let r=new class{loadQueue(){try{let e=localStorage.getItem("fnote_sync_queue");if(e){let t=JSON.parse(e),s=Date.now()-6048e5;this.queue=t.filter(e=>e&&e.id&&e.type&&e.timestamp>s&&e.retries<this.maxRetries),this.saveQueue()}}catch(e){console.error("Error loading sync queue:",e),this.queue=[]}}saveQueue(){localStorage.setItem("fnote_sync_queue",JSON.stringify(this.queue))}setupListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.processQueue()}),window.addEventListener("offline",()=>{this.isOnline=!1})}cleanupOldItems(){let e=Date.now()-6048e5;this.queue=this.queue.filter(t=>t.timestamp>e&&t.retries<this.maxRetries),this.saveQueue()}addToQueue(e,t,s){if("note"===e&&(null==s?void 0:s.includes("password"))||"note"===e&&(null==s?void 0:s.includes("logged_in")))return;let n={id:"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,action:t,data:s,timestamp:Date.now(),synced:!1,retries:0};this.queue.push(n),this.saveQueue(),this.isOnline&&!this.isSyncing&&this.processQueue()}async syncToAPI(e){try{let t={note:"/api/notes",goal:"/api/goals",plan:"/api/planner",thought:"/api/thoughts",learned:"/api/learned"}[e.type];if(!t)return!1;let s=localStorage.getItem("fnote_user"),n=s?JSON.parse(s):null;if(!n)return console.warn("No user data for sync"),!1;let i=await fetch(t,{method:"delete"===e.action?"DELETE":"update"===e.action?"PUT":"POST",headers:{"Content-Type":"application/json","x-user-data":JSON.stringify(n)},body:JSON.stringify(e.data)});return i.ok}catch(e){return console.error("Sync to API failed:",e),!1}}async processQueue(){if(!this.isSyncing&&this.isOnline&&0!==this.queue.length){this.isSyncing=!0;try{let e=this.queue.filter(e=>!e.synced);for(let t of e){let e=await this.syncToAPI(t);e?(t.synced=!0,t.retries=0):(t.retries+=1,t.retries>=this.maxRetries&&console.warn("Max retries reached for item: ".concat(t.id))),await new Promise(e=>setTimeout(e,100))}this.queue=this.queue.filter(e=>!e.synced||e.retries<this.maxRetries),this.saveQueue(),console.log("Sync completed. ".concat(e.filter(e=>e.synced).length," items synced"))}catch(e){console.error("Sync process failed:",e)}finally{this.isSyncing=!1}}}getPendingCount(){return this.queue.filter(e=>!e.synced).length}clearQueue(){this.queue=[],this.saveQueue()}constructor(){this.queue=[],this.isOnline=!1,this.isSyncing=!1,this.maxRetries=3,this.isOnline=navigator.onLine,this.loadQueue(),this.setupListeners(),this.cleanupOldItems()}};function a(){let[e,t]=(0,i.useState)(0),[s,a]=(0,i.useState)(!1),[o,l]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(l(!0),!r)return;let e=()=>{if(r){let e=r.getPendingCount();t(e)}a(!1)};e();let s=setInterval(e,1e4);return()=>{clearInterval(s)}},[]);let c=async()=>{if(!navigator.onLine){alert("You need to be online to sync");return}r&&(a(!0),await r.processQueue(),a(!1),r&&t(r.getPendingCount()))};return o&&0!==e?(0,n.jsx)("div",{className:"fixed bottom-4 left-4 z-40 animate-fade-in",children:(0,n.jsx)("div",{className:"bg-gradient-to-r from-[#143b28] to-[#1f5a3d] text-white px-3 py-2 rounded-lg shadow-lg border border-[#d4af37]/30",children:(0,n.jsx)("div",{className:"flex items-center gap-2",children:s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,n.jsx)("span",{className:"text-xs",children:"Syncing to server..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-xs",children:"\uD83D\uDCE1"}),(0,n.jsxs)("span",{className:"text-xs",children:[e," change",1!==e?"s":""," pending"]}),(0,n.jsx)("button",{onClick:c,className:"ml-2 text-xs text-[#d4af37] hover:underline",disabled:!navigator.onLine,children:"Sync now"})]})})})}):null}},7059:function(){},2941:function(e,t,s){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=s(5587),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,s){var n,r={},c=null,d=null;for(n in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,n)&&!l.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===r[n]&&(r[n]=t[n]);return{$$typeof:i,type:e,key:c,ref:d,props:r,_owner:o.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},587:function(e,t,s){"use strict";e.exports=s(2941)}},function(e){e.O(0,[399,258,744],function(){return e(e.s=4108)}),_N_E=e.O()}]);